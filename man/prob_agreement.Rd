% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/prob_agreement.R
\name{prob_agreement}
\alias{prob_agreement}
\title{Estimation of the Agreement Probability in the Bivariate Normal-Birnbaum-Saunders Distribution}
\usage{
prob_agreement(y, c)
}
\arguments{
\item{y}{A matrix or data.frame of dimension \eqn{n \times 2}, containing a sample from the bivariate NBS distribution.
Each row corresponds to one observation of the two measurements.}

\item{c}{A positive threshold value \eqn{c > 0} that defines the agreement band.}
}
\value{
A list with the following elements:
\describe{
  \item{\code{estimate}}{Point estimate of \eqn{\psi_c}.}
  \item{\code{std_error}}{Asymptotic standard error.}
  \item{\code{lower_limit}}{Lower bound of the 95\% confidence interval.}
  \item{\code{upper_limit}}{Upper bound of the 95\% confidence interval.}
}
}
\description{
This function estimates the agreement probability \eqn{\psi_c} for two measurements
that follow a bivariate Normal-Birnbaum-Saunders (NBS) joint distribution.
The estimation is based on an observed sample \eqn{y} and a threshold value \eqn{c}.
}
\details{
The function uses the EM algorithm to obtain the maximum likelihood estimators of the parameters,
and then computes the point estimate of \eqn{\psi_c}, its asymptotic standard error,
and an asymptotic confidence interval based on the normal approximation.


The agreement probability \eqn{\psi_c} is defined as
\deqn{ \psi_c = P(|Y_1 - Y_2| \leq c) }
where \eqn{(Y_1, Y_2)} follows a bivariate NBS distribution.

The procedure is as follows:
\enumerate{
  \item Estimate the parameters of the bivariate NBS distribution using the EM algorithm.
  \item Compute the mean difference and the variance of the difference.
  \item Obtain the point estimate of \eqn{\psi_c}.
  \item Derive the asymptotic standard error from the Fisher information matrix.
  \item Construct the 95\% asymptotic confidence interval.
}
}
\examples{
\dontrun{
# Generate a sample of size 200 from the bivariate NBS distribution (illustrative example)
set.seed(123)
y <- matrix(rnorm(400), ncol = 2)  # replace with a proper NBS generator

# Compute the agreement probability with threshold c = 1
prob_agreement(y, c = 1)
}

}
\seealso{
\code{\link{emNBS}}, \code{\link{fisher_information}}, \code{\link{pNBS0}}, \code{\link{dNBS0}}
}
